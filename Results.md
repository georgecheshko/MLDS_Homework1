Студент МОВС2022 Чешко Георгий Дмитриевич

Домашняя работа №1

1.Введение
В данной работе мной был проведен разведочный анализ данных, с дальнейшим построением предстказательной модели несколькими методами.
В качестве данных были предоставлены несколько датасетов : тренировочный и тестовый. Данные были загружены на учебный репозиотрий группы.

2.Данные
Датасеты представляли собой таблицы с несколькими признаками автомобиля , такими как:
"Модель автомобиля", "Год выпуска", "Цена продажи", "Пробег в километрах", "Тип топлива", "Статус продавца", "Тип трансмиссии",
"Кол-во владельцев", "Расход топлива", "Объем двигателя", "Кол-во лошадиных сил" (британских),"Крутящий момент", "Кол-во мест".

На первом этапе работы с данными мы оценили количество пропусков. Кол-во пропусков оказалось незначительно - около 2 процентов.
Пропуски были заполнены медианой (средним) значением, учитывая процент пропусков это разумно. Данные остались репрезентативными.

На втором этапе проведен контроль наличия строк - "дубликатов". Повторяющиеся строки были удалены.

На этом подготовка данных была закончена.

3.Визуализация

Для предварительного анализа данных , было проведено построения попарного распределения признаков в тренировочном датафрейме.
Сделаны предварительные выводы о связи переменных.
Построен график попарного распределения признаков в тестовом датафрейме.
Оценено соответсвие графиков. В целом рапределение данных в тестовом датафрейме , аналогично тренировочному.

Построено тепловая карта попарных корреляций для числовых признаков.
Выявлена высокая положительная взаимосвязь между: 
"Ценой" и "Кол-во лошадиныхсил"
"Объем двигателя" - "Кол-во лошадиных сил"
"Кол-во мест" - "Объемом двигателя"  (несколько удивительна такая связь)

Выявлена высокая отрицательная зависимость между:
"Объем двигателя" - "Расход"  (возможно в силу совершенствования совеременных технологий (трубины))
"Кол-во мест" - "Расход"  (с учетом высокой связи мест сидения и объема двигателя , неудивительно )

Дополнительно в рамках  анализа были построены гистограммы зависимости:

Гистограмма  "Тип топлива" - "Объем двигателя".
Гистограмма "Тип топлива" - "Максимальная мощность".
Выявлено , что при использовании дизельного топлива "Максимальная мощность" больше чем у бензина на 30 %,и больше 
чем у сжиженных газов на 40 %.
Предложено провести OneHot-кодирование данного категориального признака.

4.Построение моделей.
На данном этапе обучены несколько моделей.
1.Линейная регрессия; 2.Линейная регрессия на стандартизированных данных; 3.Линейная регрессия с L1 регуляризацией;
4.Линейная регрессия с L1 по оптимизированным парметрам; 5.Метод опорных веторов для регрессии(LinearSVR)

Оценены R^2 и MSE.

1. R2 = 0.5939 MSE = 233397306765
2. R2 = 0.5650 MSE = 249998332752
3. R2 = 0.5650 MSE = 249998691150
4. R2 = 0.5650 MSE = 249998691150
5. R2 = -0.5527

На основании результатов обученных моделей мы видим , что точность моделей достаточно низка. А MSE - высокое.
При применении L1 регуляризации веса модели не занулялись. Но порядок весов уменьшился.
Методы регуляризации в даном случае оказалист неэффективны. Наибольшую точность дает модель обычной Линейной регрессии.


5.Построение моделей с добавлением категориальных признаков.

Проведено OneHot кодирование категориальных признаков (в том числе seats, который в предыдущих моделях был числовым).
В виду отсутствия некоторых признаков в тестовой выборке , она была дополнена столбцами с "0".

Определен оптимальный параметр alpha = 7.5 Линейной регрессией с L2 регуляризацией.
Для моделей "ROC AUC" оказался достаточно высокий. Но R2-низкий.

Были обучены 2 модели: с числовыми seats; с категориальными seats.

При использовании числовых seats качество модели максимально R2 = 0.63
При использовании категориальных seats качество модели R2 = 0.34

6. Генерация новых признаков.
Сформирован и добавлен в выборки новый признак - "Объем двигателя на лошадиную силу".
Обучены модели:
Линейной регрессии с новым признаком; с новым признаком при удалении старого.
Линейной регрессии ( L2 регуляризацией) с новым признаком; с новым признаком при удалении старого.

Качество модели на Линейной регрессии существенно упало R2 = 0.127
Качество модели на Линейной регрессии с L2 существенно не изменилось R2 = 0.5.


7.Дополнительный анализ полученной модели.
В рамках отдельной метрики посчитан процент предсказанных цен отличающихся от точных данных на 10 процентов.
По результатам 24 процента ценовых характеристик предсказанных машин отличаются более чем на 10 процентов.


На основаниий проведенной работы сделаны следующие выводы:

1. Для представленных данных методы регуляризации не дали существенного прироста качества модели.
2. Отсутсвие улучшения качества модели от прмиенения методом регуляризации подозрительно. Возможно допусщена ошибка в коде, переменных,
логике решения задач.
3. Кодирование категориальных признаков при решении задач машинного обучения индивидуально. В ходе работы числовое кодирование признаков
дало лучший результат по сравнению с OneHot-кодированием.
4. Полученные результаты качества модели не удовлетворяют разумным требованиям точности.В использование обученные модели не допускаются.

Проблемные вопросы:
1. При подготовке данных к ML  в виду недостаточных знаний Python , код был переусложнен.
2. Работать в одном ноутбуке с несколькими моделями неудобно. Постоянно приходится деражть в голове какие операции были  сданнымии.
3.Feature Engineering проведен плохо. С другой стороны , работать с признаками можно до бесконечности.










